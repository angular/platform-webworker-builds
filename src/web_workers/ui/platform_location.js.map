{"version":3,"file":"platform_location.js","sourceRoot":"","sources":["../../../../../../modules/@angular/platform-webworker/src/web_workers/ui/platform_location.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {LocationChangeListener} from '@angular/common';\nimport {Injectable} from '@angular/core';\n\nimport {EventEmitter} from '../../facade/async';\nimport {BrowserPlatformLocation} from '../../private_import_platform-browser';\nimport {MessageBus} from '../shared/message_bus';\nimport {ROUTER_CHANNEL} from '../shared/messaging_api';\nimport {LocationType} from '../shared/serialized_types';\nimport {PRIMITIVE, Serializer} from '../shared/serializer';\nimport {ServiceMessageBroker, ServiceMessageBrokerFactory} from '../shared/service_message_broker';\n\n\nexport class MessageBasedPlatformLocation {\nprivate _channelSink: EventEmitter<Object>;\nprivate _broker: ServiceMessageBroker;\n/**\n * @param {?} _brokerFactory\n * @param {?} _platformLocation\n * @param {?} bus\n * @param {?} _serializer\n */\nconstructor(\nprivate _brokerFactory: ServiceMessageBrokerFactory,\nprivate _platformLocation: BrowserPlatformLocation, bus: MessageBus,\nprivate _serializer: Serializer) {\n    this._platformLocation.onPopState(<LocationChangeListener>this._sendUrlChangeEvent.bind(this));\n    this._platformLocation.onHashChange(\n        <LocationChangeListener>this._sendUrlChangeEvent.bind(this));\n    this._broker = this._brokerFactory.createMessageBroker(ROUTER_CHANNEL);\n    this._channelSink = bus.to(ROUTER_CHANNEL);\n  }\n/**\n * @return {?}\n */\nstart(): void {\n    this._broker.registerMethod('getLocation', null, this._getLocation.bind(this), LocationType);\n    this._broker.registerMethod('setPathname', [PRIMITIVE], this._setPathname.bind(this));\n    this._broker.registerMethod(\n        'pushState', [PRIMITIVE, PRIMITIVE, PRIMITIVE],\n        this._platformLocation.pushState.bind(this._platformLocation));\n    this._broker.registerMethod(\n        'replaceState', [PRIMITIVE, PRIMITIVE, PRIMITIVE],\n        this._platformLocation.replaceState.bind(this._platformLocation));\n    this._broker.registerMethod(\n        'forward', null, this._platformLocation.forward.bind(this._platformLocation));\n    this._broker.registerMethod(\n        'back', null, this._platformLocation.back.bind(this._platformLocation));\n  }\n/**\n * @return {?}\n */\nprivate _getLocation(): Promise<Location> {\n    return Promise.resolve(this._platformLocation.location);\n  }\n/**\n * @param {?} e\n * @return {?}\n */\nprivate _sendUrlChangeEvent(e: Event): void {\n    const /** @type {?} */ loc = this._serializer.serialize(this._platformLocation.location, LocationType);\n    const /** @type {?} */ serializedEvent = {'type': e.type};\n    this._channelSink.emit({'event': serializedEvent, 'location': loc});\n  }\n/**\n * @param {?} pathname\n * @return {?}\n */\nprivate _setPathname(pathname: string): void { this._platformLocation.pathname = pathname; }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ServiceMessageBrokerFactory, },\n{type: BrowserPlatformLocation, },\n{type: MessageBus, },\n{type: Serializer, },\n];\n}\n\nfunction MessageBasedPlatformLocation_tsickle_Closure_declarations() {\n /** @type {?} */\nMessageBasedPlatformLocation.decorators;\n /**\n  * @nocollapse\n  * @type {?}\n  */\nMessageBasedPlatformLocation.ctorParameters;\n /** @type {?} */\nMessageBasedPlatformLocation.prototype._channelSink;\n /** @type {?} */\nMessageBasedPlatformLocation.prototype._broker;\n /** @type {?} */\nMessageBasedPlatformLocation.prototype._brokerFactory;\n /** @type {?} */\nMessageBasedPlatformLocation.prototype._platformLocation;\n /** @type {?} */\nMessageBasedPlatformLocation.prototype._serializer;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}